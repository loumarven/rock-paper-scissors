<!DOCTYPE html>
  <head>
    <title>Rock Paper Scissors</title>
    <meta charset="utf-8">
    <script>
      function computerPlay() {
        let result;
        let num = Math.random();
        if (num <= 0.33) {
          result = "Rock";
        } else if (num <= 0.66) {
          result = "Paper";
        } else {
          result = "Scissors";
        }
        return result;
      }

      function playRound(playerSelection, computerSelection) {
        let player = playerSelection.toLowerCase();
        let computer = computerSelection.toLowerCase();
        let result;

        if (player === "rock") {
          if (computer === "scissors") {
            result = "win";
          } else if (computer === "paper") {
            result = "lose";
          } else {
            result = "tie";
          }
        } else if (player === "paper") {
          if (computer === "rock") {
            result = "win";
          } else if (computer === "scissors") {
            result = "lose";
          } else {
            result = "tie";
          }
        } else if (player === "scissors") {
          if (computer === "paper") {
            result = "win";
          } else if (computer === "rock") {
            result = "lose";
          } else {
            result = "tie";
          }
        } else {
          result = "invalid choice";
        }

        if (result === "win" || result === "lose") {
          return `You ${result}! ${player} beats ${computer}!`;
        } else if (result === "tie"){
          return "It's a tie!";
        } else {
          return result;
        }
      }

      function game() {
        let playerScore = 0;
        let computerScore = 0;
        let result;
        let round = 0;
        let greeting = "Enter your weapon";

        while (round < 5) {
          let player = prompt(greeting);
          let computer = computerPlay();

          let roundResult = playRound(player, computer);
          console.log(roundResult);
          if (roundResult.search("win") != -1) {
            playerScore++;
          } else if (roundResult.search("lose") != -1) {
            computerScore++;
          }

          if (roundResult.search("invalid") === -1) { // count round only if player input is valid
            round++;
          } else {
            greeting = "Choices: rock | paper | scissors";
          }
          console.log({"playerScore" : playerScore, "computerScore" : computerScore});
        }

        if (playerScore > computerScore) {
          result = "YOU WON THE GAME!";
        } else if (playerScore < computerScore) {
          result = "YOU LOST THE GAME!";
        } else {
          result = "IT'S A TIE!";
        }

        alert(result);
      }

      game();
    </script>
  </head>
  <body>
  </body>
</html>
